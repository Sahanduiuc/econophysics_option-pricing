\chapter{(C) Formule di valutazione esatte} \label{cap:exactformulas}

In questa sezione riportiamo gli studi sulla valutazione della formula del prezzo dell'opzione \textit{performance corridor} (\ref{eq:performancecorridor_pay-off}) in diversi casi limite dei suoi parametri. 

\section{(C-0) Formule analitiche per i limiti asintotici della barriera}

Il primo parametro preso in considerazione è $B$, cioè la variabile adimensionale che indica l'altezza della barriera.

\subsection{(C-0-i) \texorpdfstring{$B=0$}{B=0}}

In questo caso la condizione
\begin{equation}
\left| \frac{1}{\sqrt{\Delta t}} \log{\frac{S(t_{i+1})}{S(t_i)}} \right| < B\sigma  
\label{eq:performance_corridor_condition_exact_formulas}
\end{equation}
non è mai soddisfatta e la quantità $P_{i}$ nella \eqref{eq:performancecorridor_barrier} assume sempre un valore nullo. Di conseguenza il \textit{pay-off} risulta sempre nullo poiché la quantità $[-K]^{+}$ vale $0$ essendo $K$ una costante positiva nell'intervallo $[0,1]$, ovvero
\begin{equation}
    F_{pc} = 0 \,.
\end{equation}

Le simulazioni effettuate restituiscono un prezzo dell'opzione nullo confermando così il risultato previsto e avvalorando ulteriormente l'interpretazione avanzata in Sezione \ref{sec:pc_pricing}.

\subsection{(C-0-ii) \texorpdfstring{$B\rightarrow \infty$}{B->infinity}}

In questo caso la condizione \eqref{eq:performance_corridor_condition_exact_formulas} è sempre soddisfatta e la $P_{i}$ assume sempre un valore pari a $1$. Di conseguenza il \textit{pay-off} risulta essere
\begin{equation}
    F_{pc}=N(1-K),
\end{equation}
dove la parte positiva è stata tralasciata poiché $K \in [0,1]$. Si noti che quest'ultima espressione dovrà essere attualizzata al valore della data odierna moltiplicando il \textit{pay-off} per il fattore di attualizzazione $e^{-r T}$.

In Tabella \ref{tab:Teo-MC_B} riportiamo il confronto tra alcuni valori ottenuti dalle simulazioni con lo schema esatto e quelli analitici previsti per diversi valori di $K$ prendendo in considerazione $m=400$ date di rilevazione.

\begin{table}[t]
\small
\centering
\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline
$B$ & $K$ & $F_\text{MC}$ & $\epsilon_\text{MC}$ & $F_{forecast}$ & Discrepanza in unità di $\epsilon_\text{MC}$ \\
\hline \hline
$100$ & $30\%$ & $0.69992995$ & $1.8 \cdot 10^{-7}$ &
$0.69993$ & $0.3$\\ \hline
$50$ & $50\%$ & $0.49994996$ & $1.4 \cdot 10^{-7}$ & $0.49995$ & $0.3$\\ \hline
$10$ & $60\%$ & $0.39995997$ & $1.2 \cdot 10^{-7}$ & $0.39996$ & $0.3$\\ \hline
$8$ & $40\%$ & $0.59993982$ & $1 \cdot 10^{-7}$ & $0.59994$ & $1.8$\\ \hline
$6$ & $30\%$ & $0.69992979$ & $1 \cdot 10^{-7}$ & $0.69993$ & $2.1$\\ \hline
$5$ & $20\%$ & $0.79991938$ & $1.9 \cdot 10^{-7}$ & $0.79992$ & $3.3$\\ \hline
\end{tabular}
\caption{Confronto tra i prezzi dell'opzione \textit{performance corridor} calcolati tramite simulazioni Monte Carlo e quelli previsti dalla formula analitica per $B \rightarrow \infty$.}
\label{tab:Teo-MC_B}
\end{table}


Dalla tabella si evince che i risultati ottenuti attraverso le simulazioni sono compatibili con i valori previsti poiché il prezzo dell'opzione è contenuto entro un intervallo di $\epsilon_\text{MC}$ per valori di $B$ maggiori di 10, confermando i risultati ottenuti in Sezione \ref{sec:pc_pricing}. Con valori di $B \in [5,10]$ i risultati ottenuti sono ancora compatibili con quelli attesi poiché i prezzi sono contenuti entro un intervallo di $2 \epsilon_\text{MC}$, ma iniziano a mostrare i limiti di applicabilità della formula. Nei casi in cui $B<5$ la formula ricavata precedentemente non è più applicabile e i risultati delle simulazioni non sono compatibili con quelli previsti, poiché la distanza con valori attesi è maggiore di $3 \epsilon_\text{MC}$ .

\section{(C-1) Formula analitica per singola data di rilevazione}

Il secondo parametro preso in considerazione è $m$, cioè il numero di date di rilevazione. Inizialmente abbiamo imposto nella formula \eqref{eq:performancecorridor_pay-off} il vincolo $m=1$, ottenendo
\begin{equation}
    F_{pc}=N[P-K]^{+},
\end{equation}
dove:
\begin{equation}
    P = \begin{cases}
    1, & \text{se} \,\,\left| \log{\frac{S(T)}{S(0)}} \right| < B \sigma \sqrt{\Delta t};\\
    0, & \text{altrimenti},
    \label{eq:pc_condition}
  \end{cases}
\end{equation}
che possiamo riscrivere nella forma
\begin{equation}
    F_{pc} = \begin{cases}
    N(1-K), & \text{se} \,\,\left| \log{\frac{S(T)}{S(0)}} \right| < B\sigma \sqrt{\Delta t};\\
    0, & \text{altrimenti},
  \end{cases}
\end{equation}
dove è stata omessa la parte positiva poiché la quantità tra parentesi quadre è sempre maggiore di zero.

Utilizzando il modello del moto browniano geometrico, secondo il quale il prezzo del sottostante segue un processo lognormale, il valore che il prezzo assume alla data di maturità è dato dalla formula
\begin{equation}
    S(T) = S(0) \exp{\left[\left(r- \frac{\sigma^2}{2}\right)T + \sigma \sqrt{T} w\right]}.
\end{equation}
Pertanto il \textit{pay-off} assume il valore $N(1-K)$ se e solo se viene rispettata la condizione
\begin{equation}
    \left| \left(r- \frac{\sigma^2}{2}\right) \frac{\sqrt{T}}{\sigma} + w \right| < B.
    \label{eq:condition}
\end{equation}

Il prezzo dell'opzione sarà quindi dato dal valore del suo \textit{pay-off} nel caso in cui questo non sia nullo, moltiplicato per la probabilità $p$ che la condizione \eqref{eq:condition} sia soddisfatta e per il fattore di attualizzazione:
\begin{equation}
    F_{pc}=N(1-K) \cdot p \cdot e^{-rT}.
\end{equation}
Essendo $w$ un numero pseudocasuale gaussiano con media nulla e varianza unitaria si può ottenere
\begin{equation}
    p = \mathcal{N}[B-c] - \mathcal{N}[-B-c],
\end{equation}
dove
\begin{equation}
    c:=\left(r- \frac{\sigma^2}{2}\right) \frac{\sqrt{T}}{\sigma}
\end{equation}
e $\mathcal{N}(x)$ indica la funzione di distribuzione normale cumulata (\ref{eq:cumulative_gaussian})

In conclusione la formula analitica esatta dell'opzione per una singola data di rilevazione è data dalla formula
\begin{equation}
    F_{pc}=N(1-K) \cdot \left(\mathcal{N}[B-c] - \mathcal{N}[-B-c] \right) \cdot e^{-rT}
\end{equation}

In Tabella \ref{tab:Teo-MC_m} riportiamo il confronto tra alcuni valori ottenuti dalle simulazioni con lo schema esatto e quelli analitici previsti per diversi valori di $B$, $K$ e $\sigma$ prendendo in considerazione una singola data di rilevazione

\begin{table}[t]
\small
\centering
\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline
$B$ & $K$ & $\sigma$ & $F_\text{MC}$ & $\epsilon_\text{MC}$ & $F_{forecast}$ & Discrepanza in unità di $\epsilon_\text{MC}$ \\
\hline \hline
$0.25$ & $0\%$ & $30 \%$ & $0.195182$ & $4 \cdot 10^{-5}$ & $0.19524$ & $1.4$\\ \hline
$0.2$ & $10\%$ & $25\%$ & $0.141511$ & $3.3 \cdot 10^{-5}$ & $0.141565$ & $1.6$\\ \hline
$0.45$ & $20\%$ & $40 \%$ & $0.272619$ & $3.8 \cdot 10^{-5}$ & $0.272674$ & $1.4$\\ \hline
$0.5$ & $20\%$ & $30\%$ & $0.303115$ & $3.9 \cdot 10^{-5}$ & $0.303171$ & $1.4$\\ \hline
$2$ & $20\%$ & $25 \%$ & $0.762175$ & $1.7 \cdot 10^{-5}$ & $0.762181$ & $0.3$\\ \hline
$5$ & $40\%$ & $60 \%$ & $0.599939253$ & $6.7 \cdot 10^{-8}$ & $0.599939188$ & $0.9$\\ \hline
\end{tabular}
\caption{Confronto tra i prezzi dell'opzione \textit{performance corridor} calcolati tramite simulazioni Monte Carlo e quelli previsti dalla formula analitica per $m=1$.}
\label{tab:Teo-MC_m}
\end{table}

Dalla tabella si evince che i risultati ottenuti attraverso le simulazioni evidenziano una buona compatibilità con i valori previsti poiché il prezzo dell'opzione è contenuto entro un intervallo di $2\epsilon_\text{MC}$ per tutti i valori di $B$, $K$ e $\sigma$ considerati.


\section{(C-2) Formula analitica per date di rilevazione asintoticamente infinite}

In opposizione al caso precedente abbiamo considerato il limite $m \rightarrow \infty$; in questo caso, cioè con il numero di date di rilevazione che tende all'infinito, l'intervallo di tempo che intercorre tra una rilevazione del prezzo del sottostante e la successiva tende a zero, ovvero per $m \rightarrow \infty$ si ottiene che $\Delta t \rightarrow 0$. Di conseguenza nella \eqref{eq:exactprice} è possibile trascurare il primo termine in $\Delta t$ ottenendo così la formula
\begin{equation}
     S(t_{i+1}) = S(t_i) \exp{\left[ \sigma \sqrt{\Delta t} w\right]}.
\end{equation}
Si può facilmente riscrivere la condizione \eqref{eq:performancecorridor_barrier} nel seguente modo:
\begin{equation}
    P_i = \begin{cases}
    1, & \text{se} \,\,\left| w \right| < B;\\
    0, & \text{altrimenti}.
    \label{eq:condition_m}
  \end{cases}
\end{equation}
Nel limite considerato la quantità $ \frac{1}{m} \sum_{i}{P_i}$ che compare nella formula del \textit{pay-off} \eqref{eq:performancecorridor_pay-off} tende alla probabilità che la variabile $P_{i}$ assuma il valore $1$:
\begin{equation}
    \lim_{m \to \infty} \frac{1}{m} \sum_{i=0}^{m-1}{P_i} = p := P\left(P_{i}=1\right).
\end{equation}

Analogamente al caso precedente, essendo $w$ un numero casuale gaussiano con media nulla e varianza unitaria, si ottiene
\begin{equation}
    p = \mathcal{N}[B] - \mathcal{N}[-B],
\end{equation}
dove $\mathcal{N}[x]$ indica la funzione di distribuzione normale cumulata (\ref{eq:cumulative_gaussian}).

\begin{table}[t]
\small
\centering
\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline
$B$ & $K$ & $F_\text{MC}$ & $\epsilon_\text{MC}$ & $F_{forecast}$ & Distanza in unità di $\epsilon_\text{MC}$ \\
\hline \hline
$0.2$ & $10\%$ & $0.0585131$ & $1.2 \cdot 10^{-6}$ & $0.0585136$ & $0.4$\\ \hline
$0.4$ & $10\%$ & $0.2108203$ & $1.5 \cdot 10^{-6}$ & $0.2108224$ & $1.4$\\ \hline
$0.6$ & $30\%$ & $0.1514766$ & $1.6 \cdot 10^{-6}$ & $0.1514786$ & $1.3$\\ \hline
$1$ & $40\%$ & $0.2826586$ & $1.5 \cdot 10^{-6}$ & $0.2826612$ & $1.8$\\ \hline
$1$ & $60\%$ & $0.0826793$ & $1.5 \cdot 10^{-6}$ & $0.0826812$ & $1.3$\\ \hline
$1.4$ & $30\%$ & $0.5384306$ & $1.2 \cdot 10^{-6}$ & $0.5384328$ & $1.9$\\ \hline
$1.6$ & $20\%$ & $0.69033141$ & $10 \cdot 10^{-7}$ & $0.69033238$ & $0.9$\\ \hline
$1.6$ & $80\%$ & $0.09039223$ & $9.9 \cdot 10^{-7}$ & $0.09039238$ & $0.2$\\ \hline
$1.8$ & $40\%$ & $0.52808665$ & $8.3 \cdot 10^{-7}$ & $0.52808655$ & $0.1$\\ \hline
$2$ & $60\%$ & $0.35446482$ & $6.7 \cdot 10^{-7}$ & $0.35446429$ & $0.8$\\ \hline
$2.5$ & $80\%$ & $0.18756193$ & $3.6 \cdot 10^{-7}$ & $0.18756191$ & $0.1$\\ \hline
$3$ & $30\%$ & $0.69723002$ & $2.5 \cdot 10^{-7}$ & $0.69723048$ & $1.9$\\ \hline
$3.5$ & $70\%$ & $0.29950445$ & $1.3 \cdot 10^{-7}$ & $0.29950479$ & $2.7$\\ \hline
$4$ & $90\%$ & $0.09992644$ & $4.9 \cdot 10^{-7}$ & $0.09992666$ & $4.6$\\ \hline
\end{tabular}
\caption{Confronto tra i prezzi dell'opzione \textit{performance corridor} calcolati tramite simulazioni Monte Carlo e quelli previsti dalla formula analitica per $m \rightarrow \infty$.}
\label{tab:Teo-MC_m_inf}
\end{table}

In conclusione la formula analitica esatta dell'opzione per il limite con un numero elevato di date di rilevazione è data dalla formula
\begin{equation}
    F_{pc}=N[\mathcal{N}[B] - \mathcal{N}[-B]-K]^{+} e^{-rT}.
\end{equation}
Si noti che a differenza del caso precedente, in cui $m=1$, la formula ricavata è indipendente dalla volatilità.

In Tabella \ref{tab:Teo-MC_m_inf} riportiamo il confronto tra alcuni valori ottenuti dalle simulazioni con lo schema esatto e quelli analitici previsti per diversi valori di $B$ e $K$ prendendo in considerazione $m=10^4$ date di rilevazione.

Dalla tabella si nota che i risultati ottenuti attraverso le simulazioni presentano una buona compatibilità con i valori previsti poiché il prezzo dell'opzione ricade entro un intervallo di $2\epsilon_\text{MC}$ per tutti i valori di $B$ e $K$ considerati; una discrepanza maggiore di $3\epsilon_{MC}$ è stata ottenuta solo per valori di $B$ superiori a $4$. Inoltre le simulazioni stimano correttamente il prezzo dell'opzione per tutte quelle combinazioni di $B$ e $K$ tale per cui il \textit{pay-off} previsto è nullo.